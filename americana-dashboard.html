<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Americana Landscape Co. — CEO Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;overflow:hidden}
body{font-family:'DM Sans',system-ui,sans-serif;background:#0a0f1a;color:#e2e8f0}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#1e293b;border-radius:3px}
input[type="checkbox"]{accent-color:#10b981;cursor:pointer;width:18px;height:18px}
select{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' fill='%2364748b' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center;padding-right:24px!important}
input:focus,select:focus{border-color:#10b981!important;outline:none}
@media(max-width:767px){
  input[type="checkbox"]{width:20px;height:20px}
}
</style>
</head>
<body>
<div id="root"></div>
<script>
"use strict";
var h=React.createElement,useState=React.useState,useEffect=React.useEffect,useMemo=React.useMemo;

var C={bg:"#0a0f1a",card:"#111827",bdr:"#1e293b",tx:"#e2e8f0",mut:"#64748b",dim:"#475569",pri:"#10b981",red:"#ef4444",amb:"#f59e0b",blu:"#3b82f6",pur:"#8b5cf6",cyn:"#06b6d4"};

function Ic(name,sz,col){
  var s=sz||18,c=col||"currentColor";
  var P={
    home:["M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z","M9 22V12h6v10"],
    checkSq:["M9 11l3 3L22 4","M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"],
    building:["M6 22V4a2 2 0 012-2h8a2 2 0 012 2v18","M6 12H4a2 2 0 00-2 2v6a2 2 0 002 2h2","M18 9h2a2 2 0 012 2v9a2 2 0 01-2 2h-2"],
    dollar:["M12 1v22","M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"],
    shield:["M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"],
    users:["M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2","M9 11a4 4 0 100-8 4 4 0 000 8z","M23 21v-2a4 4 0 00-3-3.87","M16 3.13a4 4 0 010 7.75"],
    alert:["M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z","M12 9v4","M12 17h.01"],
    chevL:["M15 18l-6-6 6-6"],chevR:["M9 18l6-6-6-6"],
    plus:["M12 5v14","M5 12h14"],
    trash:["M3 6h18","M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"],
    check:["M20 6L9 17l-5-5"],
    clock:["M12 2a10 10 0 100 20 10 10 0 000-20z","M12 6v6l4 2"],
    refresh:["M1 4v6h6","M23 20v-6h-6","M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"],
    target:["M12 2a10 10 0 100 20 10 10 0 000-20z","M12 6a6 6 0 100 12 6 6 0 000-12z","M12 10a2 2 0 100 4 2 2 0 000-4z"],
    menu:["M3 12h18","M3 6h18","M3 18h18"],
    table:["M9 3H5a2 2 0 00-2 2v4m6-6h10a2 2 0 012 2v4M9 3v18m0 0h10a2 2 0 002-2V9M9 21H5a2 2 0 01-2-2V9m0 0h18"]
  };
  var paths=P[name]||P.home;
  return h("svg",{width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:c,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0}},
    paths.map(function(d,i){return h("path",{key:i,d:d})})
  );
}

function fmt(n){if(n>=1e6)return"$"+(n/1e6).toFixed(1)+"M";if(n>=1e3)return"$"+(n/1e3).toFixed(0)+"K";return"$"+n.toLocaleString()}
function fmtF(n){return"$"+n.toLocaleString()}
function ld(k,d){try{var v=localStorage.getItem("am_"+k);return v?JSON.parse(v):d}catch(e){return d}}
function sv(k,v){try{localStorage.setItem("am_"+k,JSON.stringify(v))}catch(e){}}

function SvgBar(props){
  var data=props.data,mob=props.mob,W=mob?360:720,H=mob?160:200;
  var mx=0;data.forEach(function(d){mx=Math.max(mx,d.actual||0,d.forecast||0)});if(!mx)mx=1;
  var L=mob?36:50,T=10,B=26,cw=W-L-10,ch=H-T-B;
  var bw=Math.min(mob?16:26,(cw/data.length)-4);
  var tY=T+ch-(366667/mx)*ch;
  var els=[];
  [0,0.5,1].forEach(function(f,i){
    var y=T+ch-f*ch;
    els.push(h("line",{key:"g"+i,x1:L,x2:W-10,y1:y,y2:y,stroke:C.bdr,strokeDasharray:"3 3"}));
    els.push(h("text",{key:"gl"+i,x:L-4,y:y+4,textAnchor:"end",fill:C.mut,fontSize:mob?8:10,fontFamily:"JetBrains Mono,monospace"},fmt(f*mx)));
  });
  if(!mob){els.push(h("line",{key:"tl",x1:L,x2:W-10,y1:tY,y2:tY,stroke:C.dim,strokeDasharray:"6 4"}));els.push(h("text",{key:"tt",x:W-10,y:tY-4,textAnchor:"end",fill:C.dim,fontSize:9},"$367K target"));}
  data.forEach(function(d,i){
    var x=L+(i/data.length)*cw+(cw/data.length-bw)/2;
    var val=d.actual||d.forecast||0;
    var bh=Math.max((val/mx)*ch,1);
    var color=d.actual?"#22c55e":d.forecast<200000?C.red:C.blu;
    var op=d.actual?1:0.6;
    els.push(h("rect",{key:"b"+i,x:x,y:T+ch-bh,width:bw,height:bh,rx:2,fill:color,opacity:op}));
    els.push(h("text",{key:"bl"+i,x:x+bw/2,y:H-6,textAnchor:"middle",fill:C.mut,fontSize:mob?7:10},mob?d.month.slice(0,1):d.month));
    if(!mob&&val>mx*0.06)els.push(h("text",{key:"bv"+i,x:x+bw/2,y:T+ch-bh-4,textAnchor:"middle",fill:C.mut,fontSize:8,fontFamily:"JetBrains Mono,monospace"},fmt(val)));
  });
  return h("svg",{viewBox:"0 0 "+W+" "+H,style:{width:"100%",height:"auto"}},els);
}

function SvgPie(props){
  var data=props.data,sz=props.mob?80:110,cx=sz/2,cy=sz/2,r=sz*0.38,ir=sz*0.2;
  var total=0;data.forEach(function(d){total+=d.value});
  var ang=-90,arcs=[];
  data.forEach(function(d){
    var a=(d.value/total)*360,s1=ang*Math.PI/180,s2=(ang+a)*Math.PI/180;ang+=a;
    var x1=cx+r*Math.cos(s1),y1=cy+r*Math.sin(s1),x2=cx+r*Math.cos(s2),y2=cy+r*Math.sin(s2);
    var ix1=cx+ir*Math.cos(s2),iy1=cy+ir*Math.sin(s2),ix2=cx+ir*Math.cos(s1),iy2=cy+ir*Math.sin(s1);
    arcs.push(h("path",{key:d.name,d:"M"+x1+" "+y1+" A"+r+" "+r+" 0 "+(a>180?1:0)+" 1 "+x2+" "+y2+" L"+ix1+" "+iy1+" A"+ir+" "+ir+" 0 "+(a>180?1:0)+" 0 "+ix2+" "+iy2+" Z",fill:d.color}));
  });
  return h("svg",{viewBox:"0 0 "+sz+" "+sz,style:{width:sz,height:sz}},arcs);
}

var DEF_T=[
  {id:"t-1",title:"Call MLGP \u2014 $85,772 outstanding, $17K at 90+ days",owner:"Robson",category:"collections",priority:1,due:"This Week",completed:false},
  {id:"t-2",title:"Schedule employment attorney consultation for 1099 audit",owner:"Robson",category:"compliance",priority:1,due:"This Week",completed:false},
  {id:"t-3",title:"Get workers\u2019 comp quotes for field crew (12-14 workers exposed)",owner:"Robson",category:"compliance",priority:1,due:"This Week",completed:false},
  {id:"t-4",title:"H&W Rockwall collection call \u2014 $8,926 at 90+ days",owner:"Robson",category:"collections",priority:1,due:"This Week",completed:false},
  {id:"t-5",title:"Populate bid values on ALL 92 Sales Hot List items",owner:"Jason",category:"pipeline",priority:2,due:"Next 2 Weeks",completed:false},
  {id:"t-6",title:"Define Karly\u2019s role \u2014 weekly outputs & accountability",owner:"Robson",category:"operations",priority:2,due:"Next 2 Weeks",completed:false},
  {id:"t-7",title:"Clarify Cipriano\u2019s role and title in org chart",owner:"Robson",category:"operations",priority:2,due:"Next 2 Weeks",completed:false},
  {id:"t-8",title:"Set hard filing deadlines with JW Hopp for 2023/2024 taxes",owner:"Robson",category:"financial",priority:2,due:"Next 2 Weeks",completed:false},
  {id:"t-9",title:"QBO chart of accounts setup (construction-specific)",owner:"JW Hopp",category:"financial",priority:2,due:"Next 2 Weeks",completed:false},
  {id:"t-10",title:"Connect Chase bank feeds to QBO",owner:"JW Hopp",category:"financial",priority:2,due:"Next 2 Weeks",completed:false},
  {id:"t-11",title:"Identify & prioritize bids for Q4 2026 work (revenue cliff)",owner:"Jason",category:"pipeline",priority:3,due:"Next 30 Days",completed:false},
  {id:"t-12",title:"Siteline implementation kickoff",owner:"Robson",category:"operations",priority:3,due:"Next 30 Days",completed:false},
  {id:"t-13",title:"Time tracking tool selection and field crew rollout",owner:"Robson",category:"operations",priority:3,due:"Next 30 Days",completed:false},
  {id:"t-14",title:"Migrate AP/AR from Excel to QBO",owner:"JW Hopp",category:"financial",priority:3,due:"Next 30 Days",completed:false},
  {id:"t-15",title:"Complete lien waiver backlog (81% incomplete \u2014 42 of 52)",owner:"Karly",category:"admin",priority:3,due:"Next 30 Days",completed:false},
  {id:"t-r1",title:"Review AR aging \u2014 follow up on 30+ day invoices",owner:"Robson",category:"collections",priority:2,due:"Weekly",completed:false,recurring:"weekly"},
  {id:"t-r2",title:"Update WIP % complete on active projects",owner:"Robson",category:"operations",priority:2,due:"Weekly",completed:false,recurring:"weekly"},
  {id:"t-r3",title:"Review weekly payroll for accuracy",owner:"Karly",category:"financial",priority:2,due:"Weekly",completed:false,recurring:"weekly"},
  {id:"t-r4",title:"Submit pay applications for active projects",owner:"Robson",category:"financial",priority:1,due:"Monthly",completed:false,recurring:"monthly"}
];
var DEF_P=[
  {id:"26001",name:"Encore Wire",client:"H&W",tc:906269,rem:906269,pct:0,st:"not_started",bond:false,start:"Mar 2026",notes:""},
  {id:"25024",name:"Celina DT Center",client:"Swinerton",tc:670226,rem:670226,pct:0,st:"not_started",bond:true,start:"Apr 2026",notes:""},
  {id:"25006",name:"Allen Police",client:"Core",tc:680823,rem:622631,pct:9,st:"active",bond:false,notes:""},
  {id:"25022",name:"McKinney TKI Terminal",client:"Swinerton",tc:920340,rem:615580,pct:33,st:"active",bond:true,notes:""},
  {id:"25019",name:"GISD Multi Program",client:"Core",tc:370525,rem:364074,pct:2,st:"active",bond:false,notes:""},
  {id:"25023",name:"Schwab GH2 Expansion",client:"Swinerton",tc:346622,rem:346622,pct:0,st:"not_started",bond:false,start:"Jun 2026",notes:""},
  {id:"25003",name:"Sherman Stadium",client:"Core",tc:830090,rem:263600,pct:68,st:"active",bond:false,notes:""},
  {id:"26003",name:"Coppell Lakeside ES",client:"Core",tc:208590,rem:208590,pct:0,st:"not_started",bond:false,notes:""},
  {id:"25004",name:"Clearfork C2",client:"Whiting Turner",tc:312091,rem:198460,pct:36,st:"active",bond:false,notes:""},
  {id:"25026",name:"Mansfield ISD Barber",client:"Core",tc:208336,rem:198296,pct:5,st:"active",bond:false,notes:""},
  {id:"25018",name:"Shiloh Retail",client:"XS",tc:124690,rem:116005,pct:7,st:"active",bond:false,notes:""},
  {id:"25028",name:"Sandbox Scholar",client:"XS Construction",tc:51425,rem:51425,pct:0,st:"not_started",bond:false,notes:""},
  {id:"26002",name:"Rasa Aviation",client:"MLGP",tc:49000,rem:49000,pct:0,st:"not_started",bond:false,notes:""},
  {id:"24029",name:"Shiloh Office Park",client:"XS",tc:68830,rem:47275,pct:31,st:"active",bond:false,notes:""}
];
var DEF_AR=[
  {id:"ar-1",client:"MLGP",project:"Multiple",amount:85772,aging:"Mixed",risk:"high",notes:"$17K at 90+ \u2014 call NOW",lc:""},
  {id:"ar-2",client:"H&W",project:"Rockwall",amount:8926,aging:"90+",risk:"high",notes:"Small but 90+ overdue",lc:""},
  {id:"ar-3",client:"Swinerton",project:"McKinney Terminal",amount:304760,aging:"0-30",risk:"monitor",notes:"Largest single receivable",lc:""},
  {id:"ar-4",client:"Whiting Turner",project:"Clearfork C2",amount:113631,aging:"0-30",risk:"monitor",notes:"New client \u2014 watch",lc:""},
  {id:"ar-5",client:"Core",project:"Sherman Stadium",amount:58306,aging:"0-30",risk:"low",notes:"Reliable payer",lc:""},
  {id:"ar-6",client:"H&W",project:"SPR Packaging",amount:46445,aging:"0-30",risk:"low",notes:"On track",lc:""},
  {id:"ar-7",client:"XS",project:"Multiple",amount:39413,aging:"0-30",risk:"low",notes:"Reliable",lc:""},
  {id:"ar-8",client:"Core",project:"Multiple Smaller",amount:47149,aging:"30-90",risk:"monitor",notes:"Mixed aging",lc:""},
  {id:"ar-9",client:"Ready",project:"Tom Thumb",amount:19835,aging:"0-30",risk:"low",notes:"Standard",lc:""}
];
var DEF_M=[
  {id:"m-1",task:"JW Hopp onboarded with clear scope",st:"partial",owner:"Toby",note:"Onboarded \u2014 scope unclear",wk:"Wk 1-2"},
  {id:"m-2",task:"QBO chart of accounts setup",st:"not_started",owner:"JW Hopp",note:"Blocked",wk:"Wk 1-2"},
  {id:"m-3",task:"Migrate AP/AR from Excel to QBO",st:"not_started",owner:"JW Hopp",note:"",wk:"Wk 1-2"},
  {id:"m-4",task:"Chase bank feeds connected",st:"not_started",owner:"JW Hopp",note:"",wk:"Wk 1-2"},
  {id:"m-5",task:"Employment attorney consultation",st:"not_started",owner:"Robson",note:"OVERDUE",wk:"Wk 1-6"},
  {id:"m-6",task:"Workers\u2019 comp quote & bind",st:"not_started",owner:"Robson",note:"OVERDUE",wk:"Wk 1-6"},
  {id:"m-7",task:"Siteline implementation",st:"not_started",owner:"Robson",note:"",wk:"Wk 2-4"},
  {id:"m-8",task:"Time tracking rollout",st:"not_started",owner:"Robson",note:"",wk:"Wk 3-6"},
  {id:"m-9",task:"Karly role definition",st:"not_started",owner:"Robson",note:"Paid $85K/yr",wk:"Wk 1-6"},
  {id:"m-10",task:"Sales Hot List values populated",st:"not_started",owner:"Jason",note:"92 items at $0",wk:"Wk 1-6"},
  {id:"m-11",task:"Monthly close within 10 days",st:"not_started",owner:"JW Hopp",note:"",wk:"Wk 3-6"},
  {id:"m-12",task:"5 core SOPs documented",st:"not_started",owner:"Nick/Toby",note:"",wk:"Wk 3-6"}
];
var DEF_C=[
  {id:"c-1",label:"1099 \u2192 W-2 Conversion",st:"critical",detail:"12-14 field workers misclassified. $250K-$500K+ exposure.",owner:"Robson + Attorney",dl:"ASAP",notes:""},
  {id:"c-2",label:"Workers\u2019 Comp Policy",st:"critical",detail:"Only Robson & Jason covered. Field crew ZERO coverage.",owner:"Robson",dl:"ASAP",notes:""},
  {id:"c-3",label:"Tax Filing (2023 & 2024)",st:"warning",detail:"JW Hopp at $420/mo. No confirmed filing dates.",owner:"JW Hopp",dl:"Mar 2026",notes:""},
  {id:"c-4",label:"Lien Waiver Backlog",st:"warning",detail:"10 of 52 uploaded (19%). Payment delay risk.",owner:"Karly",dl:"Apr 2026",notes:""},
  {id:"c-5",label:"Pipeline Values",st:"warning",detail:"92 items with $0 values. Analytics broken.",owner:"Jason",dl:"Mar 2026",notes:""},
  {id:"c-6",label:"Bank Account Restructuring",st:"in_progress",detail:"Need separate: operating, tax reserve, payroll.",owner:"Robson",dl:"Mar 2026",notes:""}
];
var BILL=[{month:"Jan",forecast:159000,actual:159000},{month:"Feb",forecast:636000,actual:485000},{month:"Mar",forecast:358921,actual:null},{month:"Apr",forecast:545000,actual:null},{month:"May",forecast:825000,actual:null},{month:"Jun",forecast:536622,actual:null},{month:"Jul",forecast:450000,actual:null},{month:"Aug",forecast:590000,actual:null},{month:"Sep",forecast:543340,actual:null},{month:"Oct",forecast:93495,actual:null},{month:"Nov",forecast:51425,actual:null},{month:"Dec",forecast:0,actual:null}];
var CLIENTS=[{name:"Core",value:2523848,pct:32.7,color:"#3b82f6"},{name:"Swinerton",value:2078438,pct:26.9,color:"#8b5cf6"},{name:"H&W",value:1500061,pct:19.4,color:"#06b6d4"},{name:"Whiting-T",value:312091,pct:4.0,color:"#f97316"},{name:"XS",value:380259,pct:4.9,color:"#eab308"},{name:"Others",value:933581,pct:12.1,color:"#64748b"}];
var ARAGE=[{bucket:"Current (0-30)",amount:596350,color:"#22c55e"},{bucket:"31-60 days",amount:47149,color:"#eab308"},{bucket:"61-90 days",amount:86310,color:"#f97316"},{bucket:"90+ days",amount:25926,color:"#ef4444"}];
var TEAMD=[{name:"Robson Pritchett",role:"President/Owner",pay:"$133K/yr",note:"THE BOTTLENECK"},{name:"Jason Fuller",role:"VP Estimating",pay:"$86K/yr",note:"Has bandwidth"},{name:"Karly Pritchett",role:"Office Admin",pay:"$85K/yr",note:"Role undefined"},{name:"Andres Sanchez",role:"Lead Foreman",pay:"$35/hr",note:"Potential super"},{name:"Diego Sanchez",role:"Foreman",pay:"$35/hr",note:""},{name:"Cipriano",role:"Unknown Title",pay:"~$2,400/wk",note:"NOT in org chart"},{name:"Uriel Toledano",role:"Asst. Foreman",pay:"$24/hr",note:""}];
var OWNERS=["Robson","Jason","Karly","JW Hopp","Nick/Toby","Andres"];
var CATS=["compliance","collections","pipeline","operations","financial","admin"];

/* SMALL COMPONENTS */
function Bdg(p){return h("span",{style:{fontSize:10,fontWeight:600,padding:"2px 8px",borderRadius:4,background:p.bg||C.bdr,color:p.color||C.mut,whiteSpace:"nowrap",display:"inline-flex",alignItems:"center",gap:4}},p.children)}
function SBd(p){
  var m={critical:{b:C.red+"18",c:C.red,l:"CRITICAL"},warning:{b:C.amb+"18",c:C.amb,l:"WARNING"},in_progress:{b:C.blu+"18",c:C.blu,l:"IN PROGRESS"},done:{b:C.pri+"18",c:C.pri,l:"DONE"},high:{b:C.red+"18",c:C.red,l:"ACTION"},monitor:{b:C.amb+"18",c:C.amb,l:"WATCH"},low:{b:C.pri+"18",c:C.pri,l:"OK"},active:{b:C.pri+"18",c:C.pri,l:"ACTIVE"},not_started:{b:C.bdr,c:C.mut,l:"NOT STARTED"},closing:{b:C.blu+"18",c:C.blu,l:"CLOSING"},complete:{b:C.pri+"18",c:C.pri,l:"COMPLETE"}};
  var s=m[p.status]||m.low;
  return h("span",{onClick:p.onClick,style:{fontSize:10,fontWeight:600,padding:"3px 8px",borderRadius:4,background:s.b,color:s.c,cursor:p.onClick?"pointer":"default",border:"1px solid "+s.c+"30",userSelect:"none"}},s.l);
}
function PDot(p){return h("span",{style:{width:8,height:8,borderRadius:"50%",background:{1:C.red,2:C.amb,3:C.blu}[p.p],display:"inline-block",flexShrink:0}})}
function CBdg(p){var cc={compliance:C.red,collections:C.amb,pipeline:C.blu,operations:C.pur,financial:C.pri,admin:C.mut};return h("span",{style:{fontSize:10,padding:"2px 6px",borderRadius:4,background:(cc[p.cat]||C.mut)+"15",color:cc[p.cat]||C.mut,fontWeight:500}},p.cat)}
function PBar(p){var v=p.value||0,ht=p.h||6;return h("div",{style:{width:"100%",height:ht,background:C.bdr,borderRadius:ht,overflow:"hidden"}},h("div",{style:{width:Math.max(v,2)+"%",height:"100%",background:v===0?C.dim:v<30?C.blu:v<70?C.cyn:C.pri,borderRadius:ht,transition:"width 0.3s"}}))}
function KPI(p){return h("div",{style:{background:p.alert?C.red+"10":C.card,border:"1px solid "+(p.alert?C.red+"30":C.bdr),borderRadius:10,padding:p.mob?12:16}},h("div",{style:{fontSize:p.mob?18:22,fontWeight:700,color:p.alert?C.red:C.tx,letterSpacing:"-0.5px",fontFamily:"JetBrains Mono,monospace"}},p.value),h("div",{style:{fontSize:p.mob?10:11,color:C.mut,marginTop:2}},p.label),p.sub?h("div",{style:{fontSize:p.mob?9:10,color:p.alert?C.red+"99":C.dim,marginTop:4}},p.sub):null)}
function Sel(p){return h("select",{value:p.value,onChange:function(e){p.onChange(e.target.value)},style:{background:C.card,border:"1px solid "+C.bdr,color:C.tx,borderRadius:6,padding:"6px 8px",fontSize:12,width:p.width||140,cursor:"pointer",fontFamily:"DM Sans",minHeight:36}},p.options.map(function(o){var v=typeof o==="string"?o:o.v,l=typeof o==="string"?o:o.l;return h("option",{key:v,value:v},l)}))}
function Modal(p){return h("div",{onClick:p.onClose,style:{position:"fixed",inset:0,background:"#000000aa",display:"flex",alignItems:p.mob?"flex-end":"center",justifyContent:"center",zIndex:50}},h("div",{onClick:function(e){e.stopPropagation()},style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:p.mob?"16px 16px 0 0":12,padding:p.mob?20:24,width:p.mob?"100%":"auto",maxWidth:p.mob?"100%":"90vw",maxHeight:p.mob?"85vh":"auto",overflowY:"auto"}},p.children))}
function TH(p){return h("th",{style:{padding:"10px 12px",textAlign:p.right?"right":"left",fontSize:11,fontWeight:500,color:C.mut,whiteSpace:"nowrap"}},p.children)}
function TD(p){return h("td",{style:Object.assign({padding:"10px 12px",textAlign:p.right?"right":"left",fontFamily:p.mono?"JetBrains Mono,monospace":undefined,fontWeight:p.bold?600:undefined,fontSize:p.mono?11:12,whiteSpace:p.nowrap?"nowrap":undefined},p.sx||{})},p.children)}

/* ═══ MAIN APP ═══ */
function App(){
  var pg=useState("dashboard"),sb=useState(true);
  var tasks=useState(function(){return ld("tasks",DEF_T)});
  var proj=useState(function(){return ld("proj",DEF_P)});
  var ar=useState(function(){return ld("ar",DEF_AR)});
  var miles=useState(function(){return ld("miles",DEF_M)});
  var comp=useState(function(){return ld("comp",DEF_C)});
  var showAdd=useState(false),eId=useState(null),eF=useState(""),eV=useState("");
  var tf=useState("all"),of_=useState("all"),ps=useState(""),pf=useState("all");
  var showReset=useState(false),saving=useState(false);
  var nt=useState({title:"",owner:"Robson",category:"operations",priority:2,due:"This Week"});
  var winW=useState(window.innerWidth);

  var page=pg[0],setPg=pg[1],sidebar=sb[0],setSb=sb[1];
  var T=tasks[0],setT=tasks[1],P=proj[0],setP=proj[1],A=ar[0],setA=ar[1],M=miles[0],setM=miles[1],CO=comp[0],setCO=comp[1];
  var add=showAdd[0],setAdd=showAdd[1],eid=eId[0],setEid=eId[1],ef=eF[0],setEf=eF[1],ev=eV[0],setEv=eV[1];
  var catF=tf[0],setCatF=tf[1],ownF=of_[0],setOwnF=of_[1],pSrch=ps[0],setPSrch=ps[1],pFilt=pf[0],setPFilt=pf[1];
  var rst=showReset[0],setRst=showReset[1],sav=saving[0],setSav=saving[1];
  var newT=nt[0],setNewT=nt[1];
  var ww=winW[0],setWW=winW[1];
  var mob=ww<768;

  useEffect(function(){function onR(){setWW(window.innerWidth)}window.addEventListener("resize",onR);return function(){window.removeEventListener("resize",onR)}},[]);
  useEffect(function(){var t=setTimeout(function(){setSav(true);sv("tasks",T);sv("proj",P);sv("ar",A);sv("miles",M);sv("comp",CO);setTimeout(function(){setSav(false)},400)},400);return function(){clearTimeout(t)}},[T,P,A,M,CO]);

  function startEdit(id,f,v){setEid(id);setEf(f);setEv(String(v||""))}
  function cancelEdit(){setEid(null);setEf("");setEv("")}
  function saveEdit(setter){var field=ef,val=ev,id=eid;setter(function(prev){return prev.map(function(it){if(it.id!==id)return it;var o={};o[field]=(field==="pct"||field==="amount")?Number(val):val;return Object.assign({},it,o)})});cancelEdit()}
  function toggleTask(id){setT(function(p){return p.map(function(t){return t.id===id?Object.assign({},t,{completed:!t.completed}):t})})}
  function delTask(id){setT(function(p){return p.filter(function(t){return t.id!==id})})}
  function addTask(){if(!newT.title.trim())return;setT(function(p){return p.concat([Object.assign({},newT,{id:"t-"+Date.now(),completed:false,priority:Number(newT.priority)})])});setNewT({title:"",owner:"Robson",category:"operations",priority:2,due:"This Week"});setAdd(false)}
  function toggleMile(id){setM(function(p){return p.map(function(m){return m.id===id?Object.assign({},m,{st:m.st==="not_started"?"partial":m.st==="partial"?"done":"not_started"}):m})})}
  function cycleComp(id){var o=["critical","warning","in_progress","done"];setCO(function(p){return p.map(function(c){return c.id===id?Object.assign({},c,{st:o[(o.indexOf(c.st)+1)%4]}):c})})}
  function cycleProj(id){var o=["not_started","active","closing","complete"];setP(function(p){return p.map(function(pr){return pr.id===id?Object.assign({},pr,{st:o[(o.indexOf(pr.st)+1)%4]}):pr})})}
  function cycleRisk(id){var o=["high","monitor","low"];setA(function(p){return p.map(function(a){return a.id===id?Object.assign({},a,{risk:o[(o.indexOf(a.risk)+1)%3]}):a})})}
  function resetAll(){setT(DEF_T);setP(DEF_P);setA(DEF_AR);setM(DEF_M);setCO(DEF_C);setRst(false)}

  var mDone=M.filter(function(m){return m.st==="done"}).length;
  var crit=T.filter(function(t){return!t.completed&&t.priority===1}).length;
  var critC=CO.filter(function(c){return c.st==="critical"}).length;
  var done=T.filter(function(t){return t.completed}).length;
  var fTasks=T.filter(function(t){return(catF==="all"||t.category===catF)&&(ownF==="all"||t.owner===ownF)});
  var fProj=P.filter(function(p){return(pFilt==="all"||p.st===pFilt)&&(!pSrch||p.name.toLowerCase().indexOf(pSrch.toLowerCase())>=0||p.client.toLowerCase().indexOf(pSrch.toLowerCase())>=0)});

  var d=new Date();
  var dateStr=mob?d.toLocaleDateString("en-US",{month:"short",day:"numeric"}):d.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});
  var greet=d.getHours()<12?"Good morning":d.getHours()<17?"Good afternoon":"Good evening";
  var pad=mob?14:24;

  function InEdit(p){return h("div",{style:{display:"flex",gap:4,alignItems:"center"}},h("input",{value:ev,onChange:function(e){setEv(e.target.value)},type:p.type||"text",autoFocus:true,onKeyDown:function(e){if(e.key==="Enter")p.onSave();if(e.key==="Escape")cancelEdit()},style:{background:C.bg,border:"1px solid "+C.pri,color:C.tx,borderRadius:6,padding:"6px 8px",fontSize:13,width:p.w||"100%",minHeight:36}}),h("button",{onClick:p.onSave,style:{background:C.pri+"18",border:"none",color:C.pri,borderRadius:6,padding:"6px 8px",cursor:"pointer",fontSize:14,minWidth:32,minHeight:32}},"\u2713"),h("button",{onClick:cancelEdit,style:{background:C.red+"18",border:"none",color:C.red,borderRadius:6,padding:"6px 8px",cursor:"pointer",fontSize:14,minWidth:32,minHeight:32}},"\u2715"))}

  var navItems=[{id:"dashboard",label:"Home",icon:"home"},{id:"tasks",label:"Tasks",icon:"checkSq"},{id:"projects",label:"Projects",icon:"building"},{id:"financials",label:"Money",icon:"dollar"},{id:"compliance",label:"Comply",icon:"shield"},{id:"team",label:"Team",icon:"users"},{id:"sheets",label:"Sheets",icon:"table"}];

  /* ═══ MOBILE PROJECT CARDS ═══ */
  function ProjCard(p){
    var pr=p.pr;
    return h("div",{style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:14,marginBottom:8}},
      h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8}},
        h("div",null,h("div",{style:{fontSize:13,fontWeight:600}},pr.name),h("div",{style:{fontSize:11,color:C.mut}},pr.id+" \u00B7 "+pr.client),pr.bond?h(Bdg,{bg:C.pur+"20",color:C.pur},"BONDED"):null),
        h(SBd,{status:pr.st,onClick:function(){cycleProj(pr.id)}})),
      h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:8}},
        h("div",null,h("div",{style:{fontSize:9,color:C.dim}},"CONTRACT"),h("div",{style:{fontSize:13,fontWeight:600,fontFamily:"JetBrains Mono,monospace"}},fmt(pr.tc))),
        h("div",null,h("div",{style:{fontSize:9,color:C.dim}},"REMAINING"),h("div",{style:{fontSize:13,fontWeight:600,fontFamily:"JetBrains Mono,monospace"}},fmt(pr.rem)))),
      h("div",{style:{display:"flex",alignItems:"center",gap:8}},h("div",{style:{flex:1}},h(PBar,{value:pr.pct,h:6})),
        eid===pr.id&&ef==="pct"?h(InEdit,{onSave:function(){saveEdit(setP)},type:"number",w:60}):h("span",{onClick:function(){startEdit(pr.id,"pct",pr.pct)},style:{fontSize:11,color:C.mut,cursor:"pointer",minWidth:36,textAlign:"right"}},pr.pct+"%")),
      pr.start&&pr.st==="not_started"?h("div",{style:{fontSize:10,color:C.mut,marginTop:6}},"Starts "+pr.start):null,
      h("div",{style:{marginTop:8}},eid===pr.id&&ef==="notes"?h(InEdit,{onSave:function(){saveEdit(setP)}}):h("span",{onClick:function(){startEdit(pr.id,"notes",pr.notes||"")},style:{fontSize:11,color:pr.notes?C.mut:C.dim,cursor:"pointer"}},pr.notes||"+ Add note"))
    );
  }

  /* ═══ MOBILE AR CARDS ═══ */
  function ARCard(p){
    var it=p.it;
    return h("div",{style:{background:it.risk==="high"?C.red+"10":C.card,border:"1px solid "+(it.risk==="high"?C.red+"30":C.bdr),borderRadius:10,padding:14,marginBottom:8}},
      h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6}},
        h("div",{style:{fontWeight:600,fontSize:14}},it.client),h(SBd,{status:it.risk,onClick:function(){cycleRisk(it.id)}})),
      h("div",{style:{fontSize:11,color:C.mut,marginBottom:6}},it.project+" \u00B7 "+it.aging),
      h("div",{style:{fontSize:18,fontWeight:700,fontFamily:"JetBrains Mono,monospace",marginBottom:8}},fmtF(it.amount)),
      h("div",{style:{marginBottom:4}},eid===it.id&&ef==="notes"?h(InEdit,{onSave:function(){saveEdit(setA)}}):h("span",{onClick:function(){startEdit(it.id,"notes",it.notes)},style:{fontSize:11,color:C.mut,cursor:"pointer"}},it.notes)),
      h("div",null,eid===it.id&&ef==="lc"?h(InEdit,{onSave:function(){saveEdit(setA)},w:120}):h("span",{onClick:function(){startEdit(it.id,"lc",it.lc||"")},style:{fontSize:11,color:it.lc?C.mut:C.dim,cursor:"pointer"}},"Last contact: "+(it.lc||"+ Log")))
    );
  }

  /* BUILD CONTENT */
  var content=[];

  if(page==="dashboard"){
    if(critC>0)content.push(h("div",{key:"alert",style:{background:C.red+"10",border:"1px solid "+C.red+"30",borderRadius:10,padding:mob?10:14,display:"flex",alignItems:"center",gap:10}},Ic("alert",mob?16:20,C.red),h("div",{style:{flex:1}},h("div",{style:{fontSize:mob?12:13,fontWeight:600,color:C.red}},critC+" Critical Compliance"),h("div",{style:{fontSize:mob?10:11,color:C.red+"88",marginTop:2}},"1099 misclassification & workers\u2019 comp")),h("button",{onClick:function(){setPg("compliance")},style:{background:C.red+"30",border:"none",color:C.red,borderRadius:6,padding:"6px 12px",cursor:"pointer",fontSize:11,fontWeight:600,fontFamily:"DM Sans",whiteSpace:"nowrap"}},"View")));
    content.push(h("div",{key:"kpi",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:mob?8:12}},h(KPI,{value:fmt(644000),label:"YTD Billed",sub:"14.6% of $4.4M",mob:mob}),h(KPI,{value:fmt(755735),label:"AR Outstanding",sub:"$26K at 90+",mob:mob}),h(KPI,{value:fmt(7728278),label:"Total WIP",sub:fmt(4681281)+" left",mob:mob}),h(KPI,{value:fmt(144920),label:"Q4 Forecast",sub:"Revenue cliff",alert:true,mob:mob})));
    content.push(h("div",{key:"chart",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:mob?12:20}},h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8}},h("div",null,h("div",{style:{fontSize:mob?13:14,fontWeight:600}},"2026 Billing Forecast"),h("div",{style:{fontSize:mob?10:11,color:C.mut}},"$4.8M contracted")),h("div",{style:{display:"flex",gap:12,fontSize:10,color:C.mut,alignItems:"center"}},h("span",{style:{display:"flex",gap:4,alignItems:"center"}},h("span",{style:{width:10,height:4,borderRadius:2,background:"#22c55e"}}),"Actual"),h("span",{style:{display:"flex",gap:4,alignItems:"center"}},h("span",{style:{width:10,height:4,borderRadius:2,background:C.blu,opacity:0.6}}),"Forecast"))),h(SvgBar,{data:BILL,mob:mob})));
    if(mob){
      content.push(h("div",{key:"pri",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:12}},h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8}},h("span",{style:{fontSize:13,fontWeight:600}},"Priority Actions"),h("button",{onClick:function(){setPg("tasks")},style:{background:"transparent",border:"none",color:C.pri,cursor:"pointer",fontSize:11,fontFamily:"DM Sans"}},"All \u2192")),T.filter(function(t){return!t.completed&&t.priority<=2}).slice(0,5).map(function(t){return h("div",{key:t.id,onClick:function(){toggleTask(t.id)},style:{display:"flex",alignItems:"flex-start",gap:8,padding:"8px 0",borderBottom:"1px solid "+C.bdr+"40",cursor:"pointer"}},h("input",{type:"checkbox",checked:t.completed,readOnly:true,style:{marginTop:2}}),h(PDot,{p:t.priority}),h("div",{style:{flex:1,minWidth:0}},h("div",{style:{fontSize:12,lineHeight:1.4}},t.title),h("div",{style:{fontSize:10,color:C.mut,marginTop:2}},t.owner)))})));
      content.push(h("div",{key:"pie",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:12}},h("div",{style:{fontSize:13,fontWeight:600}},"Client Concentration"),h("div",{style:{fontSize:10,color:C.amb,marginTop:2,marginBottom:10}},"Top 3 = 79% of WIP"),h("div",{style:{display:"flex",alignItems:"center",gap:12}},h(SvgPie,{data:CLIENTS,mob:true}),h("div",{style:{flex:1}},CLIENTS.map(function(c){return h("div",{key:c.name,style:{display:"flex",justifyContent:"space-between",padding:"2px 0"}},h("div",{style:{display:"flex",alignItems:"center",gap:4}},h("span",{style:{width:6,height:6,borderRadius:2,background:c.color}}),h("span",{style:{fontSize:10,color:C.mut}},c.name)),h("span",{style:{fontSize:10,fontWeight:600}},c.pct+"%"))})))));
    } else {
      var priT=T.filter(function(t){return!t.completed&&t.priority<=2}).slice(0,7);
      content.push(h("div",{key:"mid",style:{display:"grid",gridTemplateColumns:"3fr 2fr",gap:16}},h("div",{style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:16}},h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:10}},h("span",{style:{fontSize:14,fontWeight:600}},"Priority Actions"),h("button",{onClick:function(){setPg("tasks")},style:{background:"transparent",border:"none",color:C.pri,cursor:"pointer",fontSize:12,fontFamily:"DM Sans"}},"All Tasks \u2192")),priT.map(function(t){return h("div",{key:t.id,onClick:function(){toggleTask(t.id)},style:{display:"flex",alignItems:"center",gap:10,padding:"8px 10px",borderRadius:8,marginBottom:4,background:t.priority===1?C.red+"10":"transparent",border:t.priority===1?"1px solid "+C.red+"20":"1px solid transparent",cursor:"pointer"}},h("input",{type:"checkbox",checked:t.completed,readOnly:true}),h(PDot,{p:t.priority}),h("span",{style:{flex:1,fontSize:12}},t.title),h("span",{style:{fontSize:10,color:C.mut}},t.owner),h(CBdg,{cat:t.category}))})),h("div",{style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:16}},h("div",{style:{fontSize:14,fontWeight:600}},"Client Concentration"),h("div",{style:{fontSize:10,color:C.amb,marginTop:2}},"Top 3 = 79% of $7.7M WIP"),h("div",{style:{display:"flex",alignItems:"center",gap:16,marginTop:12}},h(SvgPie,{data:CLIENTS}),h("div",{style:{flex:1}},CLIENTS.map(function(c){return h("div",{key:c.name,style:{display:"flex",justifyContent:"space-between",padding:"3px 0"}},h("div",{style:{display:"flex",alignItems:"center",gap:6}},h("span",{style:{width:8,height:8,borderRadius:2,background:c.color}}),h("span",{style:{fontSize:11,color:C.mut}},c.name)),h("span",{style:{fontSize:11,fontWeight:600}},c.pct+"%"))}))))));
    }
    content.push(h("div",{key:"stats",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:mob?8:12}},h(KPI,{value:done+"/"+T.length,label:"Tasks Done",mob:mob}),h(KPI,{value:"10/52",label:"Waivers Done",sub:"81% incomplete",mob:mob}),h(KPI,{value:"92",label:"Pipeline Items",sub:"ALL at $0",mob:mob}),h(KPI,{value:fmt(203721),label:"Retainage",mob:mob})));
  }

  if(page==="tasks"){
    content.push(h("div",{key:"hd",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},h("div",null,h("h2",{style:{fontSize:mob?16:18,fontWeight:700}},"Tasks"),h("p",{style:{fontSize:11,color:C.mut}},done+"/"+T.length+" done \u00B7 "+crit+" critical")),h("button",{onClick:function(){setAdd(true)},style:{background:C.pri,border:"none",color:"#fff",borderRadius:8,padding:mob?"10px 14px":"8px 16px",cursor:"pointer",fontSize:13,fontWeight:600,display:"flex",alignItems:"center",gap:4,fontFamily:"DM Sans",minHeight:40}},Ic("plus",14,"#fff"),mob?null:" Add Task")));
    content.push(h("div",{key:"fl",style:{display:"flex",gap:6,flexWrap:"wrap"}},h(Sel,{value:catF,onChange:setCatF,options:[{v:"all",l:"All Categories"}].concat(CATS.map(function(c){return{v:c,l:c}})),width:mob?130:140}),h(Sel,{value:ownF,onChange:setOwnF,options:[{v:"all",l:"All Owners"}].concat(OWNERS.map(function(o){return{v:o,l:o}})),width:mob?110:130})));
    var actT=fTasks.filter(function(t){return!t.completed}).sort(function(a,b){return a.priority-b.priority});
    content.push(h("div",{key:"ac",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:mob?10:12}},h("div",{style:{fontSize:13,fontWeight:600,marginBottom:8,padding:"0 4px"}},"Active"),actT.length===0?h("div",{style:{fontSize:12,color:C.mut,padding:16,textAlign:"center"}},"No tasks match"):actT.map(function(t){return h("div",{key:t.id,style:{display:"flex",alignItems:"flex-start",gap:mob?8:10,padding:mob?"10px 6px":"8px 10px",borderRadius:8,marginBottom:3,background:t.priority===1?C.red+"10":"transparent",border:t.priority===1?"1px solid "+C.red+"20":"1px solid transparent"}},h("input",{type:"checkbox",checked:false,onChange:function(){toggleTask(t.id)},style:{marginTop:2}}),h(PDot,{p:t.priority}),h("div",{style:{flex:1,minWidth:0}},h("div",{style:{fontSize:12,lineHeight:1.4}},t.title),h("div",{style:{fontSize:10,color:C.mut,marginTop:2,display:"flex",gap:6,flexWrap:"wrap",alignItems:"center"}},h("span",null,t.owner),h("span",null,"\u00B7"),h("span",null,t.due),t.recurring?h("span",null,"\u21BB "+t.recurring):null,h(CBdg,{cat:t.category}))),h("button",{onClick:function(){delTask(t.id)},style:{background:"transparent",border:"none",color:C.dim,cursor:"pointer",padding:6,minWidth:32,minHeight:32}},Ic("trash",14,C.dim)))})));
    var cmpT=fTasks.filter(function(t){return t.completed});
    if(cmpT.length>0)content.push(h("div",{key:"cm",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:mob?10:12}},h("div",{style:{fontSize:13,fontWeight:600,marginBottom:8,color:C.mut}},"Completed ("+cmpT.length+")"),cmpT.map(function(t){return h("div",{key:t.id,style:{display:"flex",alignItems:"center",gap:8,padding:"6px",opacity:0.5}},h("input",{type:"checkbox",checked:true,onChange:function(){toggleTask(t.id)}}),h("span",{style:{fontSize:12,textDecoration:"line-through",flex:1}},t.title),h("button",{onClick:function(){delTask(t.id)},style:{background:"transparent",border:"none",color:C.dim,cursor:"pointer",minWidth:32,minHeight:32}},Ic("trash",14,C.dim)))})));
    if(add)content.push(h(Modal,{key:"md",onClose:function(){setAdd(false)},mob:mob},h("div",{style:{width:mob?"100%":400}},h("h3",{style:{fontSize:16,fontWeight:700,marginBottom:16}},"Add New Task"),h("div",{style:{display:"flex",flexDirection:"column",gap:12}},h("div",null,h("label",{style:{fontSize:11,color:C.mut,display:"block",marginBottom:4}},"Task"),h("input",{value:newT.title,onChange:function(e){setNewT(Object.assign({},newT,{title:e.target.value}))},placeholder:"What needs to be done?",onKeyDown:function(e){if(e.key==="Enter")addTask()},style:{width:"100%",background:C.bg,border:"1px solid "+C.bdr,color:C.tx,borderRadius:8,padding:"10px 12px",fontSize:14,fontFamily:"DM Sans",minHeight:44}})),h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}},h("div",null,h("label",{style:{fontSize:11,color:C.mut,display:"block",marginBottom:4}},"Owner"),h(Sel,{value:newT.owner,onChange:function(v){setNewT(Object.assign({},newT,{owner:v}))},options:OWNERS,width:"100%"})),h("div",null,h("label",{style:{fontSize:11,color:C.mut,display:"block",marginBottom:4}},"Category"),h(Sel,{value:newT.category,onChange:function(v){setNewT(Object.assign({},newT,{category:v}))},options:CATS,width:"100%"}))),h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}},h("div",null,h("label",{style:{fontSize:11,color:C.mut,display:"block",marginBottom:4}},"Priority"),h(Sel,{value:newT.priority,onChange:function(v){setNewT(Object.assign({},newT,{priority:Number(v)}))},options:[{v:1,l:"Critical"},{v:2,l:"High"},{v:3,l:"Important"}],width:"100%"})),h("div",null,h("label",{style:{fontSize:11,color:C.mut,display:"block",marginBottom:4}},"Due"),h(Sel,{value:newT.due,onChange:function(v){setNewT(Object.assign({},newT,{due:v}))},options:["Today","This Week","Next 2 Weeks","Next 30 Days","Weekly","Monthly"],width:"100%"})))),h("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:16}},h("button",{onClick:function(){setAdd(false)},style:{background:C.bdr,border:"none",color:C.tx,borderRadius:8,padding:"10px 16px",cursor:"pointer",fontSize:13,fontFamily:"DM Sans",minHeight:44}},"Cancel"),h("button",{onClick:addTask,disabled:!newT.title.trim(),style:{background:newT.title.trim()?C.pri:C.bdr,border:"none",color:"#fff",borderRadius:8,padding:"10px 20px",cursor:newT.title.trim()?"pointer":"default",fontSize:13,fontWeight:600,opacity:newT.title.trim()?1:0.5,fontFamily:"DM Sans",minHeight:44}},"Add Task")))));
  }

  if(page==="projects"){
    content.push(h("div",{key:"hd"},h("h2",{style:{fontSize:mob?16:18,fontWeight:700}},"Work in Progress"),h("p",{style:{fontSize:11,color:C.mut}},"35 projects \u00B7 "+fmt(7728278)+" total")));
    content.push(h("div",{key:"kp",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:mob?8:12}},h(KPI,{value:"35",label:"Projects",sub:"7 not started",mob:mob}),h(KPI,{value:fmt(4681281),label:"Remaining",mob:mob})));
    content.push(h("div",{key:"fl",style:{display:"flex",gap:6,flexWrap:"wrap"}},h("input",{placeholder:"Search...",value:pSrch,onChange:function(e){setPSrch(e.target.value)},style:{background:C.card,border:"1px solid "+C.bdr,color:C.tx,borderRadius:8,padding:"8px 12px",fontSize:12,width:mob?140:260,fontFamily:"DM Sans",minHeight:36}}),h(Sel,{value:pFilt,onChange:setPFilt,options:[{v:"all",l:"All Status"},{v:"active",l:"Active"},{v:"not_started",l:"Not Started"}],width:mob?120:150})));
    if(mob){fProj.forEach(function(pr){content.push(h(ProjCard,{key:pr.id,pr:pr}))})}
    else{content.push(h("div",{key:"tb",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,overflow:"auto"}},h("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,minWidth:800}},h("thead",null,h("tr",{style:{borderBottom:"1px solid "+C.bdr}},h(TH,null,"Project"),h(TH,null,"Client"),h(TH,{right:true},"Contract"),h(TH,{right:true},"Remaining"),h(TH,null,"Progress"),h(TH,null,"Status"),h(TH,null,"Notes"))),h("tbody",null,fProj.map(function(p){return h("tr",{key:p.id,style:{borderBottom:"1px solid "+C.bdr+"20"}},h(TD,null,h("div",{style:{fontWeight:500}},p.id+" \u2014 "+p.name),p.bond?h(Bdg,{bg:C.pur+"20",color:C.pur},"BONDED"):null,p.start&&p.st==="not_started"?h("div",{style:{fontSize:10,color:C.mut,marginTop:2}},"Starts "+p.start):null),h(TD,{sx:{color:C.mut}},p.client),h(TD,{right:true,mono:true,nowrap:true},fmtF(p.tc)),h(TD,{right:true,mono:true,bold:true,nowrap:true},fmtF(p.rem)),h(TD,{sx:{width:140}},eid===p.id&&ef==="pct"?h(InEdit,{onSave:function(){saveEdit(setP)},type:"number",w:60}):h("div",{onClick:function(){startEdit(p.id,"pct",p.pct)},style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"}},h(PBar,{value:p.pct,h:5}),h("span",{style:{fontSize:10,color:C.mut,width:30,textAlign:"right"}},p.pct+"%"))),h(TD,null,h(SBd,{status:p.st,onClick:function(){cycleProj(p.id)}})),h(TD,{sx:{maxWidth:160}},eid===p.id&&ef==="notes"?h(InEdit,{onSave:function(){saveEdit(setP)},w:140}):h("span",{onClick:function(){startEdit(p.id,"notes",p.notes||"")},style:{fontSize:11,color:p.notes?C.mut:C.dim,cursor:"pointer"}},p.notes||"+ Add note")))})))))}
  }

  if(page==="financials"){
    content.push(h("h2",{key:"hd",style:{fontSize:mob?16:18,fontWeight:700}},"Financials"));
    content.push(h("div",{key:"kp",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:mob?8:12}},h(KPI,{value:fmtF(755735),label:"AR Outstanding",mob:mob}),h(KPI,{value:"$25,926",label:"AR 90+ Days",alert:true,sub:"MLGP + H&W",mob:mob})));
    content.push(h("div",{key:"ag",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:mob?12:20}},h("div",{style:{fontSize:14,fontWeight:600,marginBottom:12}},"AR Aging"),ARAGE.map(function(b){return h("div",{key:b.bucket,style:{marginBottom:10}},h("div",{style:{display:"flex",justifyContent:"space-between",fontSize:mob?11:12,marginBottom:4}},h("span",{style:{color:C.mut}},b.bucket),h("span",{style:{fontWeight:600,fontFamily:"JetBrains Mono,monospace"}},fmtF(b.amount))),h("div",{style:{width:"100%",height:mob?14:18,background:C.bdr,borderRadius:9,overflow:"hidden"}},h("div",{style:{width:Math.max((b.amount/755735)*100,4)+"%",height:"100%",background:b.color,borderRadius:9,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:6}},h("span",{style:{fontSize:8,fontWeight:700,color:"#fff"}},((b.amount/755735)*100).toFixed(0)+"%"))))})));
    if(mob){A.slice().sort(function(a,b){return({high:0,monitor:1,low:2}[a.risk]-{high:0,monitor:1,low:2}[b.risk])||(b.amount-a.amount)}).forEach(function(it){content.push(h(ARCard,{key:it.id,it:it}))})}
    else{content.push(h("div",{key:"cl",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,overflow:"auto"}},h("div",{style:{padding:"14px 16px",borderBottom:"1px solid "+C.bdr}},h("div",{style:{fontSize:14,fontWeight:600}},"Collection Priorities")),h("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,minWidth:700}},h("thead",null,h("tr",{style:{borderBottom:"1px solid "+C.bdr}},h(TH,null,"Client"),h(TH,null,"Project"),h(TH,{right:true},"Amount"),h(TH,null,"Aging"),h(TH,null,"Risk"),h(TH,null,"Notes"),h(TH,null,"Contact"))),h("tbody",null,A.slice().sort(function(a,b){return({high:0,monitor:1,low:2}[a.risk]-{high:0,monitor:1,low:2}[b.risk])||(b.amount-a.amount)}).map(function(it){return h("tr",{key:it.id,style:{borderBottom:"1px solid "+C.bdr+"20",background:it.risk==="high"?C.red+"10":"transparent"}},h(TD,{sx:{fontWeight:500}},it.client),h(TD,{sx:{color:C.mut}},it.project),h(TD,{right:true,mono:true,bold:true,nowrap:true},fmtF(it.amount)),h(TD,{sx:{color:C.mut}},it.aging),h(TD,null,h(SBd,{status:it.risk,onClick:function(){cycleRisk(it.id)}})),h(TD,{sx:{maxWidth:200}},eid===it.id&&ef==="notes"?h(InEdit,{onSave:function(){saveEdit(setA)},w:180}):h("span",{onClick:function(){startEdit(it.id,"notes",it.notes)},style:{fontSize:11,color:C.mut,cursor:"pointer"}},it.notes)),h(TD,null,eid===it.id&&ef==="lc"?h(InEdit,{onSave:function(){saveEdit(setA)},w:100}):h("span",{onClick:function(){startEdit(it.id,"lc",it.lc||"")},style:{fontSize:11,color:it.lc?C.mut:C.dim,cursor:"pointer"}},it.lc||"+ Log")))})))))}
  }

  if(page==="compliance"){
    content.push(h("h2",{key:"hd",style:{fontSize:mob?16:18,fontWeight:700}},"Compliance"));
    CO.forEach(function(it){content.push(h("div",{key:it.id,style:{background:it.st==="critical"?C.red+"10":it.st==="warning"?C.amb+"10":C.card,border:"1px solid "+(it.st==="critical"?C.red+"30":it.st==="warning"?C.amb+"30":C.bdr),borderRadius:10,padding:mob?12:16,display:"flex",gap:mob?10:14}},Ic(it.st==="critical"||it.st==="warning"?"alert":"check",mob?18:22,it.st==="critical"?C.red:it.st==="warning"?C.amb:it.st==="done"?C.pri:C.blu),h("div",{style:{flex:1,minWidth:0}},h("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4,flexWrap:"wrap"}},h("span",{style:{fontSize:mob?13:14,fontWeight:600}},it.label),h(SBd,{status:it.st,onClick:function(){cycleComp(it.id)}})),h("p",{style:{fontSize:mob?11:12,color:C.mut,lineHeight:1.5}},it.detail),h("div",{style:{display:"flex",gap:4,marginTop:6,fontSize:11,color:C.mut,flexWrap:"wrap"}},h("span",null,"Owner: "),h("b",{style:{color:C.tx}},it.owner),h("span",null," \u00B7 "),h("b",{style:{color:it.dl==="ASAP"?C.red:C.tx}},it.dl)),h("div",{style:{marginTop:8}},eid===it.id&&ef==="notes"?h(InEdit,{onSave:function(){saveEdit(setCO)},w:"100%"}):h("span",{onClick:function(){startEdit(it.id,"notes",it.notes||"")},style:{fontSize:11,color:it.notes?C.mut:C.dim,cursor:"pointer",fontStyle:it.notes?"normal":"italic"}},it.notes||"+ Add notes...")))))});
    content.push(h("div",{key:"mh",style:{marginTop:6}},h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6}},h("span",{style:{fontSize:13,fontWeight:600}},"Phase 1 Milestones"),h("span",{style:{fontSize:11,color:C.mut}},mDone+"/"+M.length)),h(PBar,{value:(mDone/M.length)*100,h:8})));
    content.push(h("div",{key:"ml",style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:mob?10:12}},h("div",{style:{fontSize:10,color:C.mut,marginBottom:6}},"Tap to cycle status"),M.map(function(m){return h("div",{key:m.id,onClick:function(){toggleMile(m.id)},style:{display:"flex",alignItems:"flex-start",gap:8,padding:mob?"10px 6px":"8px 10px",borderRadius:8,marginBottom:2,cursor:"pointer",minHeight:40}},Ic(m.st==="done"?"check":m.st==="partial"?"clock":"target",16,m.st==="done"?C.pri:m.st==="partial"?C.amb:C.dim),h("div",{style:{flex:1,minWidth:0}},h("span",{style:{fontSize:12,textDecoration:m.st==="done"?"line-through":"none",color:m.st==="done"?C.mut:C.tx}},m.task),m.note?h("span",{style:{fontSize:10,display:"block",marginTop:2,color:m.note.indexOf("OVERDUE")>=0?C.red:C.dim}},m.note):null),mob?null:h("span",{style:{fontSize:10,color:C.mut,whiteSpace:"nowrap"}},m.owner),h(Bdg,null,m.wk))})));
  }

  if(page==="team"){
    content.push(h("h2",{key:"hd",style:{fontSize:mob?16:18,fontWeight:700}},"Team"));
    content.push(h("p",{key:"sub",style:{fontSize:11,color:C.mut}},"16 people \u00B7 ~$816K/yr \u00B7 $10-15K/wk field"));
    content.push(h("div",{key:"gr",style:{display:"grid",gridTemplateColumns:mob?"1fr":"1fr 1fr",gap:mob?8:12}},TEAMD.map(function(m){return h("div",{key:m.name,style:{background:C.card,border:"1px solid "+C.bdr,borderRadius:10,padding:mob?12:16,display:"flex",gap:12}},h("div",{style:{width:36,height:36,borderRadius:"50%",background:C.bdr,display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,fontWeight:700,flexShrink:0}},m.name.split(" ").map(function(n){return n[0]}).join("").slice(0,2)),h("div",{style:{minWidth:0}},h("div",{style:{fontSize:13,fontWeight:600}},m.name),h("div",{style:{fontSize:11,color:C.mut}},m.role),h("div",{style:{fontSize:11,color:C.mut,marginTop:2,fontFamily:"JetBrains Mono,monospace"}},m.pay),m.note?h("div",{style:{fontSize:10,color:C.amb,marginTop:3}},m.note):null))})));
    content.push(h("div",{key:"fc",style:{background:C.amb+"10",border:"1px solid "+C.amb+"30",borderRadius:10,padding:mob?12:16}},h("div",{style:{fontSize:13,fontWeight:600,color:C.amb}},"Field Crew"),h("p",{style:{fontSize:11,color:C.mut,marginTop:4}},"7+ laborers at $20.50/hr. All 1099 \u2014 W-2 conversion required.")));
  }

  var SHEETS=[{id:"ops",label:"Operations / Payroll",url:"https://docs.google.com/spreadsheets/d/1XfFTWSXQAFuUETMI50WkHBF6YbFbWvRevqyvheUG9cE/edit?usp=sharing&rm=minimal",desc:"WIP \u00B7 AR \u00B7 Forecast \u00B7 Payroll \u00B7 Waivers",edit:"https://docs.google.com/spreadsheets/d/1XfFTWSXQAFuUETMI50WkHBF6YbFbWvRevqyvheUG9cE/edit"},{id:"cor",label:"COR & Estimating",url:"https://docs.google.com/spreadsheets/d/18jyvw1ZgjyquAIm_xoctAkYk7-4vtJTS/edit?usp=sharing&rm=minimal",desc:"Change Orders \u00B7 Estimating Templates",edit:"https://docs.google.com/spreadsheets/d/18jyvw1ZgjyquAIm_xoctAkYk7-4vtJTS/edit"}];
  var sheetTab=useState("ops");var activeSheet=sheetTab[0],setActiveSheet=sheetTab[1];

  /* ═══ LAYOUT ═══ */
  return h("div",{style:{display:"flex",flexDirection:mob?"column":"row",height:"100vh",background:C.bg,color:C.tx,overflow:"hidden"}},
    /* SIDEBAR (desktop) */
    !mob?h("aside",{style:{width:sidebar?210:56,flexShrink:0,borderRight:"1px solid "+C.bdr,background:C.card+"80",display:"flex",flexDirection:"column",transition:"width 0.2s"}},
      h("div",{style:{padding:14,display:"flex",alignItems:"center",gap:sidebar?10:0,justifyContent:sidebar?"flex-start":"center",borderBottom:"1px solid "+C.bdr}},h("div",{style:{width:32,height:32,borderRadius:8,background:C.pri,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,color:"#fff",fontSize:14,flexShrink:0}},"A"),sidebar?h("div",null,h("div",{style:{fontSize:13,fontWeight:700}},"Americana"),h("div",{style:{fontSize:10,color:C.mut}},"CEO Dashboard")):null),
      h("div",{style:{flex:1,padding:"8px 6px",display:"flex",flexDirection:"column",gap:2,overflowY:"auto"}},navItems.map(function(n){var active=page===n.id;return h("button",{key:n.id,onClick:function(){setPg(n.id)},style:{width:"100%",display:"flex",alignItems:"center",gap:sidebar?10:0,justifyContent:sidebar?"flex-start":"center",padding:"8px 12px",borderRadius:8,border:"none",cursor:"pointer",fontSize:13,fontWeight:active?600:400,background:active?C.pri+"18":"transparent",color:active?C.pri:C.mut,fontFamily:"DM Sans"}},Ic(n.icon,18,active?C.pri:C.mut),sidebar?h("span",{style:{flex:1,textAlign:"left"}},n.label):null,sidebar&&(n.id==="tasks"&&crit>0)?h("span",{style:{fontSize:10,fontWeight:700,padding:"1px 6px",borderRadius:10,background:C.red+"20",color:C.red}},crit):null,sidebar&&(n.id==="compliance"&&critC>0)?h("span",{style:{fontSize:10,fontWeight:700,padding:"1px 6px",borderRadius:10,background:C.red+"20",color:C.red}},critC):null)})),
      sidebar?h("div",{style:{padding:14,borderTop:"1px solid "+C.bdr}},h("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:C.mut,marginBottom:4}},h("span",null,"Phase 1"),h("span",null,mDone+"/"+M.length)),h(PBar,{value:(mDone/M.length)*100})):null,
      h("div",{style:{padding:6,borderTop:"1px solid "+C.bdr}},h("button",{onClick:function(){setSb(!sidebar)},style:{width:"100%",background:"transparent",border:"none",color:C.mut,cursor:"pointer",padding:6,borderRadius:6,fontSize:12,display:"flex",alignItems:"center",justifyContent:"center",gap:4,fontFamily:"DM Sans"}},Ic(sidebar?"chevL":"chevR",14),sidebar?" Collapse":null))
    ):null,

    /* MAIN */
    h("main",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}},
      h("header",{style:{padding:mob?"10px 14px":"14px 24px",borderBottom:"1px solid "+C.bdr,display:"flex",alignItems:"center",justifyContent:"space-between",background:C.card+"50",flexShrink:0}},
        h("div",{style:{minWidth:0}},h("h1",{style:{fontSize:mob?15:17,fontWeight:700}},greet+", Robson"),h("p",{style:{fontSize:mob?10:11,color:C.mut}},dateStr+" \u00B7 Phase 1")),
        h("div",{style:{display:"flex",gap:6,alignItems:"center",flexShrink:0}},
          sav?h("span",{style:{fontSize:10,color:C.pri}},"Saving"):null,
          mob?null:h(Bdg,{bg:C.red+"18",color:C.red},Ic("alert",12,C.red)," "+critC),
          mob?null:h(Bdg,{bg:C.amb+"18",color:C.amb},Ic("clock",12,C.amb)," "+crit),
          h("button",{onClick:function(){setRst(true)},style:{background:C.card,border:"1px solid "+C.bdr,color:C.mut,borderRadius:6,padding:"6px 10px",cursor:"pointer",fontSize:11,display:"flex",alignItems:"center",gap:4,fontFamily:"DM Sans",minHeight:32}},Ic("refresh",12))
        )
      ),
      h("div",{style:{flex:1,overflowY:page==="sheets"?"hidden":"auto",padding:page==="sheets"?0:pad,WebkitOverflowScrolling:"touch"}},page==="sheets"?(function(){var sh=SHEETS.filter(function(s){return s.id===activeSheet})[0]||SHEETS[0];return h("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"}},h("div",{style:{padding:mob?"6px 10px":"8px 24px",display:"flex",alignItems:"center",gap:mob?6:12,borderBottom:"1px solid "+C.bdr,flexShrink:0,background:C.card,flexWrap:"wrap"}},SHEETS.map(function(s){var act=s.id===activeSheet;return h("button",{key:s.id,onClick:function(){setActiveSheet(s.id)},style:{padding:mob?"8px 12px":"6px 16px",borderRadius:6,border:"1px solid "+(act?C.pri+"40":C.bdr),background:act?C.pri+"18":"transparent",color:act?C.pri:C.mut,fontSize:mob?12:13,fontWeight:act?600:400,cursor:"pointer",fontFamily:"DM Sans",minHeight:36}},s.label)}),h("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"}},h("div",{style:{fontSize:10,color:C.dim,display:mob?"none":"block"}},sh.desc),h("a",{href:sh.edit,target:"_blank",rel:"noopener",style:{fontSize:11,color:C.pri,textDecoration:"none",padding:"5px 12px",borderRadius:6,border:"1px solid "+C.pri+"30",background:C.pri+"10",fontFamily:"DM Sans",whiteSpace:"nowrap"}},"Open in Sheets \u2197"))),h("iframe",{key:sh.id,src:sh.url,style:{flex:1,width:"100%",border:"none",background:"#fff"},allow:"clipboard-write"}))})():h("div",{style:{maxWidth:1300,display:"flex",flexDirection:"column",gap:mob?12:20}},content))
    ),

    /* BOTTOM TAB BAR (mobile) */
    mob?h("nav",{style:{display:"flex",borderTop:"1px solid "+C.bdr,background:C.card,flexShrink:0,paddingBottom:"env(safe-area-inset-bottom)"}},navItems.map(function(n){var active=page===n.id;var hasCount=(n.id==="tasks"&&crit>0)||(n.id==="compliance"&&critC>0);var cnt=n.id==="tasks"?crit:critC;return h("button",{key:n.id,onClick:function(){setPg(n.id)},style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:2,padding:"8px 0 6px",border:"none",cursor:"pointer",background:"transparent",color:active?C.pri:C.mut,fontFamily:"DM Sans",position:"relative"}},h("div",{style:{position:"relative"}},Ic(n.icon,20,active?C.pri:C.mut),hasCount?h("span",{style:{position:"absolute",top:-4,right:-8,fontSize:8,fontWeight:700,background:C.red,color:"#fff",borderRadius:8,padding:"1px 4px",lineHeight:1}},cnt):null),h("span",{style:{fontSize:9,fontWeight:active?600:400}},n.label))})):null,

    rst?h(Modal,{onClose:function(){setRst(false)},mob:mob},h("div",{style:{width:mob?"100%":360}},h("h3",{style:{fontSize:16,fontWeight:700,marginBottom:8}},"Reset All Data?"),h("p",{style:{fontSize:12,color:C.mut,marginBottom:20}},"Resets everything to defaults."),h("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"}},h("button",{onClick:function(){setRst(false)},style:{background:C.bdr,border:"none",color:C.tx,borderRadius:8,padding:"10px 16px",cursor:"pointer",fontSize:13,fontFamily:"DM Sans",minHeight:44}},"Cancel"),h("button",{onClick:resetAll,style:{background:C.red,border:"none",color:"#fff",borderRadius:8,padding:"10px 20px",cursor:"pointer",fontSize:13,fontWeight:600,fontFamily:"DM Sans",minHeight:44}},"Reset All")))):null
  );
}

ReactDOM.render(h(App), document.getElementById("root"));
</script></body></html>
